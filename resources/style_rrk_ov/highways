#some modifications
oneway=true | oneway=1 { set oneway=yes }
highway=* & ( disused=yes | abandoned=yes ) { delete highway }

( highway=ramp | highway=cycleway | highway=track | highway=byway ) & bicycle!=* { set highway=path ; set bicylce=yes }
( highway=ramp | highway=cycleway | highway=byway | highway=track ) { set highway=path }
( highway=footway | highway=pedestrian ) & access=yes { set highway=path }
highway=bridleway & ( bicycle=yes | bicycle=permissive | vehicle=yes | vehicle=permissive | motor_vehicle=yes | motor_vehicle=permissive | access=yes | access=permissive ) { set highway=path }
highway=bridleway { set highway=path ; set access=no }

highway=trunk_link { set highway=trunk }
highway=trunk { set toll=yes }
highway=primary_link { set highway=primary }
highway=secondary_link { set highway=secondary }
highway=tertiary_link { set highway=tertiary }

highway=path & ( surface=cobblestone | surface=cobblestone:flattened ) { set highway=cobblestone; delete surface; delete tracktype}
surface=* & tracktype=* { delete tracktype }
highway=path & tracktype=grade1 { set surface=paved; delete tracktype }
highway=path & ( tracktype=grade2 | tracktype=grade3 ) { set surface=normal; delete tracktype }
highway=path & ( tracktype=grade4 | tracktype=grade5 ) { set surface=unpaved; delete tracktype }

surface=paved | surface=asphalt | surface=paving_stones | surface=paving_stones:30 | surface=paving_stones:20 | surface=concrete | surface=concrete:plates | surface=concrete:lanes | surface=cement | surface=bricks | surface=wood | surface=metal { set rrk:surface=paved }
surface=normal | surface=gravel | surface=fine_gravel | surface=stone | surface= crushed_stone| surface=pebblestone | surface=grass_paver { set rrk:surface=normal }
surface=unpaved | surface=compacted | surface=dirt | surface=sand | surface=grass | surface=mud | surface=earth | surface=ground { set rrk:surface=unpaved }

highway=path & rrk:surface=paved  { set highway=paved }
highway=paved & ( smoothness=bad | smoothness=very_bad | smoothness=horrible | smoothness=very_horrible | smoothness=impassable ) { set highway=cobblestone }
highway=path & rrk:surface=normal { set highway=normal }
highway=normal & ( smoothness=bad | smoothness=very_bad | smoothness=horrible | smoothness=very_horrible | smoothness=impassable ) { set highway=bad }
highway=path & rrk:surface=unpaved { set highway=unpaved }

highway=primary & lanes>=2 & oneway=yes { set highway=primary_ol }
highway=secondary & lanes>=2 & oneway=yes { set highway=secondary_ol }
highway=tertiary & lanes>=2 & oneway=yes { set highway=tertiary_ol }
( cycleway=yes | cycleway=shared | cyclewayright=yes | cycleway:right=shared | cycleway:left=yes | cycleway:left=shared | cycleway=track | cycleway:right=track | cycleway:left=track | cycleway=lane | cycleway:right=lane | cycleway:left=lane | cycleway=right | cycleway=left| cycleway=both | cycleway=opposite_lane | cycleway=opposite_track | cycleway=designated | cycleway=share_busway | cycleway:right=designated | cycleway:right=share_busway | cycleway:left=designated | cycleway:left=share_busway ) { set rrk:cycleway=yes }
highway=primary & rrk:cycleway=yes { set highway=primary_cycle }
highway=secondary & rrk:cycleway=yes { set highway=secondary_cycle }
highway=tertiary & rrk:cycleway=yes { set highway=tertiary_cycle }
highway=* & sac_scale=* { set access=no }
highway=* & mtb:scale>1 { set access=no }


#highways with overlays and|or access=no
( highway=motorway | highway=motorway_junction ) 	& area!=yes			{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x10001 level 6 continue]
highway=motorway_link 					& area!=yes			{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x10002 level 4 continue]
highway=trunk 						& area!=yes & access=no		{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x10003 level 6 continue]
highway=trunk 						& area!=yes & access!=no	{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x10003 level 1-6 continue]
highway=trunk						& area!=yes & access!=no	{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x03 road_class=1 road_speed=1 level 0 continue]
highway=primary						& area!=yes & access=no		{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x10004 level 6 continue]
highway=primary						& area!=yes & access!=no	{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x10004 level 1-6 continue]
highway=primary 					& area!=yes & access!=no	{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x04 road_class=1 road_speed=1 level 0 continue]
highway=primary_ol					& area!=yes & access=no		{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x10004 level 6 continue]
highway=primary_ol					& area!=yes & access!=no	{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x10004 level 1-6 continue]
highway=primary_ol					& area!=yes & access!=no	{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x04 road_class=0 road_speed=1 level 0 continue]
highway=primary_cycle					& area!=yes & access=no		{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x10004 level 6 continue]
highway=primary_cycle					& area!=yes & access!=no	{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x10004 level 1-6 continue]
highway=primary_cycle					& area!=yes & access!=no	{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x04 road_class=2 road_speed=2 level 0 continue]
highway=secondary 					& area!=yes & access=no		{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x10005 level 5 continue]
highway=secondary 					& area!=yes & access!=no	{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x10005 level 1-5 continue]
highway=secondary					& area!=yes & access!=no	{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x05 road_class=1 road_speed=1 level 0 continue]
highway=secondary_ol 					& area!=yes & access=no		{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x10005 level 5 continue]
highway=secondary_ol 					& area!=yes & access!=no	{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x10005 level 1-5 continue]
highway=secondary_ol					& area!=yes & access!=no	{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x05 road_class=0 road_speed=1 level 0 continue]
highway=secondary_cycle					& area!=yes & access=no		{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x10005 level 5 continue]
highway=secondary_cycle					& area!=yes & access!=no	{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x10005 level 1-5 continue]
highway=secondary_cycle					& area!=yes & access!=no	{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x05 road_class=2 road_speed=3 level 0 continue]
highway=tertiary					& area!=yes & access=no		{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x10006 level 5 continue]
highway=tertiary					& area!=yes & access!=no	{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x10006 level 1-5 continue]
highway=tertiary					& area!=yes & access!=no	{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x06 road_class=1 road_speed=1 level 0 continue]
highway=tertiary_ol					& area!=yes & access=no		{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x10006 level 5 continue]
highway=tertiary_ol					& area!=yes & access!=no	{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x10006 level 1-5 continue]
highway=tertiary_ol					& area!=yes & access!=no	{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x06 road_class=0 road_speed=1 level 0 continue]
highway=tertiary_cycle					& area!=yes & access=no		{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x10006 level 5 continue]
highway=tertiary_cycle					& area!=yes & access!=no	{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x10006 level 1-5 continue]
highway=tertiary_cycle					& area!=yes & access!=no	{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x06 road_class=2 road_speed=4 level 0 continue]
highway=unclassified					& area!=yes & access=no		{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x10007 level 4 continue]
highway=unclassified					& area!=yes & access!=no	{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x10007 level 1-4 continue]
highway=unclassified					& area!=yes & access!=no	{ set name='${name} (${ref})' | '${ref}' | '${name}'}	[0x07 road_class=2 road_speed=2 level 0 continue]
highway=residential					& area!=yes & access=no 								[0x10008 level 3 continue]
highway=residential					& area!=yes & access!=no 								[0x10008 level 1-3 continue]
highway=residential					& area!=yes & access!=no								[0x08 road_class=2 road_speed=2 level 0 continue]
highway=living_street					& area!=yes & access=no									[0x10008 level 2 continue]
highway=living_street					& area!=yes & access!=no								[0x10008 level 1-2 continue]
highway=living_street					& area!=yes & access!=no								[0x08 road_class=2 road_speed=2 level 0 continue]
highway=service						& area!=yes & access=no									[0x10008 level 2 continue]
highway=service						& area!=yes & access!=no								[0x10008 level 1-2 continue]
highway=service						& area!=yes & access!=no								[0x08 road_class=2 road_speed=2 level 0 continue]


#overlays
( highway=motorway | highway=motorway_link | highway=motorway_junction | highway=trunk | highway=primary | highway=primary_ol | highway=primary_cycle | highway=secondary | highway=secondary_ol | highway=secondary_cycle | highway=tertiary | highway=tertiary_ol | highway=tertiary_cycle | highway=unclassified | highway=residential | highway=living_street | highway=service ) & surface=cobblestone & area!=yes { delete name ; delete ref } [0x10102 level 2 continue]
( highway=motorway | highway=motorway_link | highway=motorway_junction | highway=trunk | highway=primary | highway=primary_ol | highway=primary_cycle | highway=secondary | highway=secondary_ol | highway=secondary_cycle | highway=tertiary | highway=tertiary_ol | highway=tertiary_cycle | highway=unclassified | highway=residential | highway=living_street | highway=service ) & rrk:surface=unpaved & area!=yes { delete name ; delete ref } [0x10103 level 2 continue]
( highway=motorway | highway=motorway_link | highway=motorway_junction | highway=trunk | highway=primary | highway=primary_ol | highway=primary_cycle | highway=secondary | highway=secondary_ol | highway=secondary_cycle | highway=tertiary | highway=tertiary_ol | highway=tertiary_cycle | highway=unclassified | highway=residential | highway=living_street | highway=service ) & oneway=yes & area!=yes { delete name ; delete ref } [0x10106 continue level 2]
( highway=motorway | highway=motorway_link | highway=motorway_junction | highway=trunk | highway=primary | highway=primary_ol | highway=primary_cycle | highway=secondary | highway=secondary_ol | highway=secondary_cycle | highway=tertiary | highway=tertiary_ol | highway=tertiary_cycle | highway=unclassified | highway=residential | highway=living_street | highway=service ) & oneway=-1 & area!=yes { delete name ; delete ref } [0x10107 continue level 2]


#ways
( highway=footway | highway=pedestrian )	& area!=yes & indoor!=yes & access=no					[0x10012 level 0]
( highway=footway | highway=pedestrian )	& area!=yes & indoor!=yes & access!=no					[0x12 road_class=0 road_speed=0 level 0]
highway=steps					& area!=yes & indoor!=yes & access=no					[0x10013 level 2]
highway=steps					& area!=yes & indoor!=yes & access!=no					[0x10013 level 1-2 continue]
highway=steps					& area!=yes & indoor!=yes & access!=no					[0x13 road_class=0 road_speed=0 level 0]
highway=paved					& area!=yes & indoor!=yes & access=no					[0x10009 level 3]
highway=paved					& area!=yes & indoor!=yes & access!=no					[0x10009 level 1-3 continue]
highway=paved					& area!=yes & indoor!=yes & access!=no					[0x09 road_class=3 road_speed=7 level 0]
highway=cobblestone				& area!=yes & indoor!=yes & access=no					[0x1000A level 2]
highway=cobblestone				& area!=yes & indoor!=yes & access!=no					[0x1000A level 1-2 continue]
highway=cobblestone				& area!=yes & indoor!=yes & access!=no	{ set mkgmap:unpaved=yes }	[0x0A road_class=0 road_speed=2 level 0]
highway=normal					& area!=yes & indoor!=yes & access=no					[0x1000B level 3]
highway=normal					& area!=yes & indoor!=yes & access!=no					[0x1000B level 1-3 continue]
highway=normal					& area!=yes & indoor!=yes & access!=no					[0x0B road_class=1 road_speed=2 level 0]
highway=unpaved					& area!=yes & indoor!=yes & access=no					[0x10010 level 3]
highway=unpaved					& area!=yes & indoor!=yes & access!=no					[0x10010 level 1-3 continue]
highway=unpaved					& area!=yes & indoor!=yes & access!=no	{ set mkgmap:unpaved=yes }	[0x10 road_class=0 road_speed=1 level 0]
highway=bad					& area!=yes & indoor!=yes & access=no					[0x1000D level 2]
highway=bad					& area!=yes & indoor!=yes & access!=no					[0x1000D level 1-2 continue]
highway=bad					& area!=yes & indoor!=yes & access!=no	{ set mkgmap:unpaved=yes }	[0x0D road_class=0 road_speed=0 level 0]
highway=path					& area!=yes & indoor!=yes & access=no					[0x1000E level 3]
highway=path					& area!=yes & indoor!=yes & access!=no					[0x1000E level 1-3 continue]
highway=path					& area!=yes & indoor!=yes & access!=no	{ set mkgmap:unpaved=yes }	[0x0E road_class=1 road_speed=2 level 0]
highway=road					& area!=yes & indoor!=yes & access=no					[0x10011 level 2]
highway=road					& area!=yes & indoor!=yes & access!=no					[0x10011 level 1-2 continue]
highway=road					& area!=yes & indoor!=yes & access!=no					[0x11 road_class=1 road_speed=1 level 0]
